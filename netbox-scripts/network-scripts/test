def parse_ilo_arp_output(output):
    """Парсит ARP вывод для iLO и других нестандартных устройств."""
    import re
    
    arp_entries = []
    lines = output.strip().split('\n')
    
    for line in lines:
        # Пропускаем заголовки и служебные строки
        if any(skip_word in line.lower() for skip_word in [
            'protocol', 'address', 'age', 'hardware', 'type', 'interface',
            'total number', 'static:', 'dynamic:', 'trust:', 'load for', 'time source'
        ]):
            continue
            
        # Ищем строки с IP адресами
        # Изменено: (\S+) для age поддерживает тире, (.*) для длинных интерфейсов
        match = re.match(r'^(\S+)\s+(\d+\.\d+\.\d+\.\d+)\s+(\S+)\s+([0-9a-fA-F.]+)\s+(\S+)(?:\s+(.*))?', line.strip())
        
        if match:
            protocol, address, age, mac, type_field, interface = match.groups()
            
            arp_entry = {
                'protocol': protocol,
                'address': address,
                'age': age,
                'mac': mac,
                'type': type_field,
                'interface': interface.strip() if interface else ''
            }
            arp_entries.append(arp_entry)
    
    return arp_entries
